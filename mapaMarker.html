<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
	<title>Mapa</title>
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<link href="assets/css/plugins.css" rel="stylesheet" type="text/css" />
	<style type="text/css">
		body{
			margin: 0;
		}

		.gllpLatlonPicker{
			border:0;
			padding: 0;
			margin: 0;
		}
		
		input[type=search] {
		    -webkit-appearance: none;
		}

		input[type=search]::-webkit-search-cancel-button {
		    -webkit-appearance: searchfield-cancel-button;
		}
		
		.miUbicacion{
		    position: absolute;
            right: 3px;
            top: 10px;
            z-index: 9;
            background: transparent;
            border: 0;
		}
		
		.gllpSearchField{
		    position: absolute;
            top: 10px;
            z-index: 99;
            width: 90%;
            left: 5%;
		}
	</style>
</head>
<body>
    <div class="form-group">
	    <fieldset class="gllpLatlonPicker" >
	    
    	<div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
              <input type="search" class="gllpSearchField form-control" placeholder="Direcci&oacute;n de busqueda">
          </div> 
          <div class="col-xs-2" style="display:none;">
              <button type="button" class="gllpSearchButton btn btn-primary form-control"><i data-feather="search"></i> Buscar</button>
          </div>
        </div>  
      <div class="" style="position:relative;">
          <button class="miUbicacion"><img src="assets/img/markerMap.png"/></button>
        <div class="gllpMap" style="margin-left: 0; width: 100%; min-height: 350px !important;">Google Maps</div>
      </div>  

      <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12" style="display:none;">
          <label>Latitud:</label>
          <input type="text" class="gllpLatitude form-control" id="txt_latitud" name="txt_latitud"  value=""/>
      </div>
      <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12" style="display:none;">
          <label>Longitud:</label>
          <input type="text" class="gllpLongitude form-control" id="txt_longitud" name="txt_longitud" value=""/>
      </div>
      <div class="col-lg-2 col-md-2 col-sm-6 col-xs-12" style="display:none;">
          <label>Zoom:</label>
          <input type="number" class="gllpZoom form-control" value="15"/>
       </div> 
       <div class="col-lg-2 col-md-2 col-sm-6 col-xs-12" style="display:none;">
          <label>Direccion:</label>
          <input type="text" class="gllpLocationName form-control" value=""/>
       </div>
       <div class="col-lg-2 col-md-2 col-sm-6 col-xs-12" style="display:none;">
          <label>&nbsp;</label>
          <input type="button" class="gllpUpdateButton btn btn-primary"  value="Actualizar">
          <input type="button" class="gllpCreateRoute btn btn-primary"  value="Crear Ruta">
       </div>
       <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" style="display:none;">
              <label>Latitud Destino:</label>
              <input type="text" class="gllpLatitudeStart form-control"  value=""/>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" style="display:none;">
              <label>Longitud Destino:</label>
              <input type="text" class="gllpLongitudeStart form-control" value=""/>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" style="display:none;">
              <label>Distancia:</label>
              <input type="text" class="gllpDistance form-control" value="" id="txt_distancia_km"/>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" style="display:none;">
              <label>Tiempo:</label>
              <input type="text" class="gllpTime form-control" value="" id="txt_tiempo_ruta"/>
          </div>
    </fieldset>
    </div>
    <script src="assets/js/libs/jquery-3.1.1.min.js"></script>
	<script src="//maps.googleapis.com/maps/api/js?key=AIzaSyAHa67r_2hPqR_URtU8zsibmJx9Ahq7yGQ&libraries=places,geometry"></script>
	<script src="plugins/maps-latlon/jquery-gmaps-latlon-picker-geometry.js?v=3"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			resizeMap();
		});

		$(".gllpLatitude").on("change",function(){
			B4A.CallSub('map_LocationChange', true, $(".gllpLatitude").val(), $(".gllpLongitude").val(), $(".gllpLocationName").val());
			$(".gllpSearchField").blur();
		});
		
		$(".miUbicacion").on("click",function(){
			B4A.CallSub('map_CurrentLocation', true);
			$(".gllpSearchField").blur();
		});
		
		function validarCobertura(){
		    var distancia = $("#txt_distancia_km").val();
		    var tiempo = $("#txt_tiempo_ruta").val();
		    B4A.CallSub('map_Distance_time', true, distancia, tiempo);
			$(".gllpSearchField").blur();
		}

		function setLocation(latitud, longitud){
			$(".gllpLatitude").val(latitud);
			$(".gllpLongitude").val(longitud);
			$(".gllpUpdateButton").trigger("click");
		}
		
		function setLocationSucursal(latitud, longitud){
			$(".gllpLatitudeStart").val(latitud);
			$(".gllpLongitudeStart").val(longitud);
			$(".gllpCreateRoute").trigger("click");
		}

		function getData(){
		    var respuesta = {};
		    respuesta.latitud = $(".gllpLatitude").val();
		    respuesta.longitud = $(".gllpLongitude").val();
		    respuesta.zoom = $(".gllpZoom").val();
		    return JSON.stringify(respuesta);
		}
		
		function resizeMap(){
		    var alto = window.innerHeight - 100;
		    console.log("RESIZEE: ALTO: " + alto)
		    $(".gllpMap").height(alto);
		}
	</script>
</body>
</html>